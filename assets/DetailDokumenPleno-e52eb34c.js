import{R as x,d as K,e as L,H as M,f as P,I as w,r as B,w as k,o as T,v as F,g as i,i as r,j as e,t as l,u as n,F as N,G as q,E as _,A as I,x as R,y as C,B as V,C as U,k as j,z as A}from"./index-745e58d5.js";import{u as E}from"./dokumen-pleno-store-08baa8d6.js";import{k as z}from"./form-utils-1424947d.js";import{a as G}from"./date-utils-b77f79dd.js";import{L as H}from"./LoadingComponent-ba3eee28.js";const f=new x("komentar-pleno");function O(a,t){return f.get({page:parseInt(a),documentId:t})}function $(a){return f.store(a,"save",!0)}const J=K("komentar-pleno",{state:()=>({komentarData:[],isLoading:!1,errorMessage:"",totalData:0,page:1,lastPage:1,totalPage:1,lastNoPage:0,isSuccessSubmit:!1,loadingSubmit:!1}),actions:{getListKomentar(a){this.isLoading=!0,O(this.page,a).then(t=>{t&&(this.totalData=t.total,this.currentPage=t.current_page,this.totalPage=t.total>10?Math.ceil(t.total/10):1,this.lastNoPage=t.from,this.komentarData=t.data),this.isLoading=!1}).catch(t=>{t.response?this.errorMessage=t.response.data.message:t.request?this.errorMessage=t.request:this.errorMessage=t.message,this.isLoading=!1})},saveKomentar(a,t){this.isLoading=!0;const s=z(a,t);$(s).then(o=>{this.isLoading=!1,this.isSuccessSubmit=!0,this.getListKomentar(a.dokId)}).catch(o=>{o.response?this.errorMessage=o.response.data.message:o.request?this.errorMessage=o.request:this.errorMessage=o.message,this.isLoading=!1})}}}),Q={class:"card"},W={class:"card-body"},X={class:"row"},Y={class:"col-12 col-md-12 col-lg-8 order-2 order-md-1"},Z={class:"row p-3"},ee={class:"col-12"},te={class:"row"},se=["src"],ae={class:"mt-3"},oe=e("h4",null,"Komentar",-1),ne={key:0,class:"text-center"},ie={class:"user"},re={class:"username",style:{color:"blue"}},le={class:"col-12 mt-5"},ce=["onSubmit"],de={class:"form-group"},me={type:"submit",class:"btn btn-primary"},ue={key:0,class:"text-center spinner-border"},he={key:1},_e={class:"col-12 col-md-12 col-lg-4 order-1 order-md-2 p-3"},ge=e("h4",{class:"text-block"},"Keterangan",-1),pe={class:"text-muted"},ke=e("hr",null,null,-1),fe={class:"text-muted"},be={class:"text"},ve={class:"d-block"},De=e("div",{class:"form-group",hidden:""},[e("p",{class:"text"},"Status Dokumen"),e("select",{class:"form-control select",style:{width:"100%"},placeholder:"Silahkan Pilih Status",hidden:""},[e("option",{selected:"",disabled:""},"Silahkan Pilih Status"),e("option",{"select-id":"Belum Disahkan"},"Belum Disahkan"),e("option",{"select-id":"Dipertimbangkan"},"Dipertimbangkan"),e("option",{"select-id":"Disahkan"},"Disahkan")])],-1),Me={__name:"DetailDokumenPleno",setup(a){const t=E(),s=J(),o=L(),m=M(),{komentarData:g,loadingSubmit:b}=P(s),p=()=>({dokId:m.params.id,komentar:""}),c=w(p()),v=B(null);s.$subscribe((u,h)=>{}),k(()=>s.errorMessage,()=>{s.errorMessage&&o.add({type:"error",text:s.errorMessage})}),k(()=>s.isSuccessSubmit,()=>{Object.assign(c,p()),o.add({type:"success",text:"Komentar Berhasil di Tambahkan"})});function D(u){u.preventDefault(),s.saveKomentar(c,v.value),c.komentar=""}return T(()=>{t.getDokPlenoById(m.params.id),s.getListKomentar(m.params.id)}),(u,h)=>{const S=F("router-link");return i(),r("div",Q,[e("div",W,[e("div",X,[e("div",Y,[e("div",Z,[e("div",ee,[e("h4",null,"Nomor Dokumen: "+l(n(t).singleData.no_surat),1),e("div",te,[e("iframe",{src:n(t).singleData.dokumen_url,frameborder:"0",width:"100%",height:"800"},null,8,se)]),e("div",ae,[oe,n(g).length==0?(i(),r("div",ne," Tidak Ada Komentar ")):(i(!0),r(N,{key:1},q(n(g),(d,y)=>(i(),r("div",{class:"post",key:y},[e("div",ie,[e("span",re,l(d.nama_user),1)]),e("p",null,[_(l(d.komentar)+" ",1),e("p",null,l(n(G)(d.created_at)),1)])]))),128))])]),e("div",le,[e("form",{class:"form",onSubmit:I(D,["prevent"])},[n(s).isLoading?(i(),R(H,{key:0})):C("",!0),e("div",de,[V(e("textarea",{class:"form-control",placeholder:"Tulis Komentar","onUpdate:modelValue":h[0]||(h[0]=d=>c.komentar=d)},null,512),[[U,c.komentar]])]),e("button",me,[n(b)?(i(),r("span",ue)):(i(),r("span",he,"Komentar"))])],40,ce)])])]),e("div",_e,[ge,e("p",pe,l(n(t).singleData.keterangan),1),ke,e("div",fe,[e("p",be,[_(" Tanggal Unggah "),e("b",ve,l(n(t).singleData.tanggal_unggah),1)]),De]),j(S,{to:"dokumen",class:"btn btn-primary",hidden:""},{default:A(()=>[_(" Simpan Update")]),_:1})])])])])}}};export{Me as default};
