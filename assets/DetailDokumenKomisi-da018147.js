import{R as M,d as y,u as w,f as T,H as F,g as q,I,r as L,w as k,o as N,v as P,i as d,j as m,k as t,t as n,e as r,F as R,E as B,C as g,y as V,z as C,A as U,l as j,x as A}from"./index-8e55fb7d.js";import{u as E}from"./dokumen-komisi-store-92a25025.js";import{k as O}from"./form-utils-1424947d.js";import{f as z}from"./date-utils-ee963ed8.js";const b=new M("komentar-komisi");function H(a,e){return b.get({page:parseInt(a),documentId:e})}function $(a){return b.store(a,"save",!0)}const c=w();function v(){c.show({color:"#0069d9",blur:"5px"})}const G=y("komentar-komisi",{state:()=>({komentarData:[],errorMessage:"",totalData:0,page:1,lastPage:1,totalPage:1,lastNoPage:0,isSuccessSubmit:!1}),actions:{getListKomentar(a){v(),H(this.page,a).then(e=>{e&&(this.totalData=e.total,this.currentPage=e.current_page,this.totalPage=e.total>10?Math.ceil(e.total/10):1,this.lastNoPage=e.from,this.komentarData=e.data),c.hide()}).catch(e=>{e.response?this.errorMessage=e.response.data.message:e.request?this.errorMessage=e.request:this.errorMessage=e.message,c.hide()})},saveKomentar(a,e){v();const s=O(a,e);$(s).then(o=>{this.isSuccessSubmit=!0,c.hide(),this.getListKomentar(a.dokId)}).catch(o=>{o.response?this.errorMessage=o.response.data.message:o.request?this.errorMessage=o.request:this.errorMessage=o.message,c.hide()})}}}),J={class:"card"},Q={class:"card-body"},W={class:"row"},X={class:"col-12 col-md-12 col-lg-8 order-2 order-md-1"},Y={class:"row p-3"},Z={class:"col-12"},tt={class:"row"},et=["src"],st={class:"mt-3"},at=t("h4",null,"Komentar",-1),ot={key:0,class:"text-center"},rt={class:"user"},nt={class:"username"},it={href:"#"},ct={class:"col-12 mt-5"},lt=["onSubmit"],dt={class:"form-group"},mt=t("button",{type:"submit",class:"btn btn-primary"},"Komentar",-1),ut={class:"col-12 col-md-12 col-lg-4 order-1 order-md-2 p-3"},ht=t("h4",{class:"text-block"},"Keterangan",-1),_t={class:"text-muted"},gt=t("hr",null,null,-1),pt={class:"text-muted"},ft={class:"text-sm"},kt={class:"d-block"},St={__name:"DetailDokumenKomisi",setup(a){const e=E(),s=G(),o=T(),u=F(),{komentarData:p}=q(s),f=()=>({dokId:u.params.id,komentar:""}),l=I(f()),K=L(null);s.$subscribe((h,_)=>{}),k(()=>s.errorMessage,()=>{s.errorMessage&&o.add({type:"error",text:s.errorMessage})}),k(()=>s.isSuccessSubmit,()=>{Object.assign(l,f()),o.add({type:"success",text:"Komentar Berhasil di Tambahkan"})});function D(h){h.preventDefault(),s.saveKomentar(l,K.value)}return N(()=>{e.getDokKomisiById(u.params.id),s.getListKomentar(u.params.id)}),(h,_)=>{const S=P("router-link");return d(),m("div",J,[t("div",Q,[t("div",W,[t("div",X,[t("div",Y,[t("div",Z,[t("h4",null,"Nomor Dokumen: "+n(r(e).singleData.no_surat),1),t("div",tt,[t("iframe",{src:r(e).singleData.dokumen_url,frameborder:"0",width:"100%",height:"800"},null,8,et)]),t("div",st,[at,r(p).length==0?(d(),m("div",ot," Tidak Ada Komentar ")):(d(!0),m(R,{key:1},B(r(p),(i,x)=>(d(),m("div",{class:"post",key:x},[t("div",rt,[t("span",nt,[t("a",it,n(i.nama_user),1)])]),t("p",null,[g(n(i.komentar)+" ",1),t("p",null,n(r(z)(i.created_at)),1)])]))),128))])]),t("div",ct,[t("form",{class:"form",onSubmit:V(D,["prevent"])},[t("div",dt,[C(t("textarea",{class:"form-control",placeholder:"Tulis Komentar","onUpdate:modelValue":_[0]||(_[0]=i=>l.komentar=i)},null,512),[[U,l.komentar]])]),mt],40,lt)])])]),t("div",ut,[ht,t("p",_t,n(r(e).singleData.keterangan),1),gt,t("div",pt,[t("p",ft,[g(" Tanggal Unggah "),t("b",kt,n(r(e).singleData.tanggal_unggah),1)])]),j(S,{to:"dokumen",class:"btn btn-primary",hidden:""},{default:A(()=>[g(" Simpan Update")]),_:1})])])])])}}};export{St as default};
